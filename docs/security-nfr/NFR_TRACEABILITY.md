# NFR_TRACEABILITY — Workouts Tracking API

| NFR ID    | Story/Task (Issue title)                                    | Компонент     | Приоритет | Labels                                    | Milestone      | Проверка / Доказательства                                                     | Статус |
|-----------|-------------------------------------------------------------|---------------|-----------|-------------------------------------------|----------------|-------------------------------------------------------------------------------|--------|
| WF-NFR-01 | API errors as RFC7807 + correlation_id                      | API           | High      | type:NFR, area:api, prio:high             | M1: API & Data | BDD: @api @errors; контракт-тесты 400/404/422; unit middleware                | Open   |
| WF-NFR-02 | Pagination/limits for GET /workouts                         | API           | High      | type:NFR, area:api, prio:high             | M1: API & Data | BDD: @api pagination; e2e limit/offset; граничные значения                    | Open   |
| WF-NFR-03 | p95≤180ms @40RPS for filtered GET /workouts                 | Workouts Read | High      | type:NFR, area:observability, prio:high   | M2: Obs & Perf | BDD: @perf @obs; k6/locust профиль; Prometheus гистограммы                    | Todo   |
| WF-NFR-04 | DB indexes for filters (user_id,performed_at / exercise_id) | DB            | Medium    | type:NFR, area:ops, prio:medium           | M2: Obs & Perf | BDD: @db EXPLAIN; миграция индексов; сравнение планов                         | Todo   |
| WF-NFR-05 | Relational integrity Workout↔Set↔Exercise                   | Data Layer    | High      | type:NFR, area:api, prio:high             | M1: API & Data | BDD: @db @data property/fuzz 10k; FK/UNIQUE без нарушений                     | Open   |
| WF-NFR-06 | Idempotent POST /workouts via Idempotency-Key               | API           | Medium    | type:NFR, area:api, prio:medium           | M1: API & Data | BDD: @api идемпотентность; интеграционные ретраи                              | Open   |
| WF-NFR-07 | Structured logs w/o PII + request_id                        | Logging       | High      | type:NFR, area:security, prio:high        | M1: API & Data | BDD: @logs @security; линтер логов в CI; спот-проверка                        | Open   |
| WF-NFR-08 | Observability: metrics + tracing (OTel)                     | Observability | Medium    | type:NFR, area:observability, prio:medium | M2: Obs & Perf | BDD: @obs; /metrics содержит http_request_duration_seconds; трассы с trace_id | Todo   |
| WF-NFR-09 | Availability 99.5% for GET /workouts                        | API Read      | Medium    | type:NFR, area:ops, prio:medium           | M2: Obs & Perf | BDD: @availability; аптайм-отчёт и SLI по 5xx/таймаутам                       | Todo   |
| WF-NFR-10 | SCA gate on CI (pip-audit/safety)                           | Build/CI      | High      | type:NFR, area:security, prio:high        | M1: API & Data | BDD: @security @ops; CI job зелёный; отчёт по уязвимостям на PR               | Open   |
| WF-NFR-11 | Alembic dry-run in CI + 100% schema via migrations          | CI/DB         | Medium    | type:NFR, area:ops, prio:medium           | M1: API & Data | BDD: @ops @db; `alembic upgrade --sql` успешен; артефакт SQL в CI             | Open   |
| WF-NFR-12 | Stable sort & consistent pagination                         | API           | Low       | type:NFR, area:api, prio:low              | M1: API & Data | BDD: @api консистентное листание; пересечение страниц = ∅; tie-break по id    | Open   |
| WF-NFR-13 | Per-user data isolation (403/404 for foreign resources)     | AuthZ/API     | High      | type:NFR, area:security, prio:high        | M1: API & Data | BDD: @authz e2e: чтение/запись чужих ресурсов; негативные кейсы               | Open   |
